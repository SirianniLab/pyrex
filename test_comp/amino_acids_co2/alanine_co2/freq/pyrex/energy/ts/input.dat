
molecule{ 
0 1
 C   -2.005218033677   -0.199238039464    0.365171066565
 O   -2.183267033677   -0.071483039464    1.548171066565
 O   -2.717776033677   -0.146347039464   -0.710057933435
 N   -0.624503033677   -0.450497039464   -0.303712933435
 H   -1.535199033677   -0.277358039464   -1.217511933435
 H   -0.339892033677   -1.431514039464   -0.212527933435
 C    0.476621966323    0.432265960536    0.119586066565
 H    0.379000966323    0.583381960536    1.206769066565
 C    1.791265966323   -0.309118039464   -0.092778933435
 O    1.874996966323   -1.488367039464   -0.367322933435
 O    2.861449966323    0.485755960536    0.098375066565
 H    3.662418966323   -0.062403039464   -0.009882933435
 C    0.406614966323    1.791492960536   -0.585743933435
 H   -0.560928033677    2.263314960536   -0.386712933435
 H    1.194135966323    2.453050960536   -0.217351933435
 H    0.520726966323    1.675169960536   -1.668817933435
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
