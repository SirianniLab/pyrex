
molecule{ 
0 1
 C   -2.275438655723   -0.148470585038    0.340747625648
 O   -2.132692615894   -0.068931541528    1.525993121770
 O   -2.933953619388   -0.128299139979   -0.657279681941
 N   -0.520550841297   -0.497677125548   -0.354101470308
 H   -0.627575596714   -0.460601623495   -1.367800614555
 H   -0.277909083917   -1.460398868438   -0.114208959863
 C    0.522979996344    0.411299106923    0.114729323024
 H    0.375889561325    0.538033085032    1.197061696578
 C    1.854031674467   -0.300600645910   -0.080905749915
 O    1.937736162585   -1.479519151444   -0.361532785850
 O    2.918872177481    0.496382605153    0.109582196043
 H    3.722466600632   -0.046832056946    0.000393529658
 C    0.419357488686    1.777864867966   -0.572413881931
 H   -0.562316073706    2.218276697473   -0.373893868037
 H    1.188576768526    2.456260718635   -0.196304479597
 H    0.544407098591    1.684460631321   -1.658032513950
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
