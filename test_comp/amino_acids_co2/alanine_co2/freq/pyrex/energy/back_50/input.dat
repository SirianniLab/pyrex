
molecule{ 
0 1
 C   -2.163421371171   -0.168903311605    0.329920943385
 O   -2.135986332564   -0.077807349701    1.533540933284
 O   -2.832807511627   -0.137163593227   -0.676367682525
 N   -0.553285906535   -0.476571135052   -0.315141774899
 H   -0.715864510871   -0.409670944917   -1.320640699607
 H   -0.287648814224   -1.445079240464   -0.116954022930
 C    0.503826371173    0.432010254089    0.126576639182
 H    0.369352572121    0.570228328947    1.208767660002
 C    1.815663553810   -0.304239476469   -0.085166720190
 O    1.884664467775   -1.484214297107   -0.366981768196
 O    2.880924289787    0.487360043268    0.100857504212
 H    3.685547084447   -0.053642972063   -0.008348398462
 C    0.407785349391    1.788747548876   -0.581283335040
 H   -0.567132058145    2.243656574263   -0.382622287348
 H    1.187432093296    2.460857274875   -0.216167539222
 H    0.527162176319    1.679289942740   -1.665852717884
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
