
molecule{ 
0 1
 C   -1.987253340046   -0.201209974145    0.368946348714
 O   -2.186087699266   -0.071174664500    1.546261708528
 O   -2.715475607547   -0.146675923162   -0.716366274363
 N   -0.621545950914   -0.449969095933   -0.297744000449
 H   -1.783350745126   -0.254126059322   -1.264234810006
 H   -0.339273074484   -1.429725670373   -0.201309428630
 C    0.475532325723    0.431076724905    0.122243114905
 H    0.391505197212    0.590843718648    1.210103337150
 C    1.790342678425   -0.309093521331   -0.092617705679
 O    1.875302965325   -1.488390367594   -0.367284004290
 O    2.862034857915    0.485708227448    0.098356456730
 H    3.657226705040   -0.060096963105   -0.010351815203
 C    0.406962683440    1.791183761108   -0.585612245928
 H   -0.560679966034    2.263681488105   -0.386560898211
 H    1.194002736957    2.454332387203   -0.217827391851
 H    0.519788521702    1.673880836581   -1.668767958112
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
