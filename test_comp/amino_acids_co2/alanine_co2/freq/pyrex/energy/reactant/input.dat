
molecule{ 
0 1
 C   -2.673244057908   -0.082318217919    0.458617178709
 O   -2.260825663376   -0.024469656389    1.555775498821
 O   -3.226694416170   -0.106759285813   -0.573686474857
 N   -0.413172935569   -0.549742625917   -0.537657243233
 H   -0.422911968933   -0.475046823001   -1.554686471932
 H   -0.187557266998   -1.522050542984   -0.328636980750
 C    0.610045950900    0.323683561222    0.026873245455
 H    0.422963899988    0.395506131470    1.109522119474
 C    1.995900681337   -0.310793673179   -0.098433291142
 O    2.183727573787   -1.481504549728   -0.359921864269
 O    3.006834241051    0.549290797553    0.161582640827
 H    3.840356291640    0.042289582942    0.111710083199
 C    0.516043451064    1.733740248583   -0.567721881691
 H   -0.487450307160    2.135509046043   -0.396987995601
 H    1.245548961244    2.404966505686   -0.108586091986
 H    0.699620989780    1.718073090592   -1.649470476555
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
