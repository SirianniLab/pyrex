
molecule{ 
0 1
 C   -2.085177798366   -0.186361177001    0.339535588480
 O   -2.162714282686   -0.074922305570    1.546473264902
 O   -2.756985096527   -0.143008245371   -0.684487380548
 N   -0.595962671195   -0.459929883615   -0.305357949620
 H   -0.875836477156   -0.324566892022   -1.279670242435
 H   -0.315723604169   -1.440850311016   -0.196547205376
 C    0.486394086376    0.434129654617    0.118580248687
 H    0.358516515905    0.571935062952    1.201860297122
 C    1.797722616567   -0.307840303966   -0.091816742175
 O    1.874182153940   -1.488143774431   -0.367665045604
 O    2.862916648733    0.485403278782    0.098768495628
 H    3.665504619501   -0.057129473285   -0.006502863827
 C    0.405036580729    1.791878468416   -0.586017792354
 H   -0.563368530251    2.259979898661   -0.386089395980
 H    1.193571257497    2.450809747770   -0.216547668223
 H    0.524421346103    1.682859196933   -1.670357854848
}

set basis 6-31+G*
set_num_threads(16)
e, wfn = properties('mp2', return_wfn=True)

d = wfn.Da().to_array()
s = wfn.S().to_array()
c = wfn.Ca().to_array()
occs = c.T.dot(s.dot(d).dot(s).dot(c))

molden(wfn, 'mp2.molden', density_a = psi4.core.Matrix.from_array(occs))
